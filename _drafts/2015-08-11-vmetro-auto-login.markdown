---
layout: post
title:  "Автологин в Wi-Fi Московского метро"
date:   2015-08-11 20:40:45
categories:
- blog
---

Сим представляю перловый скрипт позволяющий автоматически залогиниться в Wi-Fi Москоского Метро. Если вы конечно используете Linux.

Скрипт написан для применения как в сочетании с wicd так и для ручного запуска. Для автоконекта с помощью wicd положите
скрипт в директорию /etc/wicd/scripts/postconnect (верно как минимум для debian).

Для network-manager -- модифицируйте его сами.

{% highlight perl %}
#!/usr/bin/perl

use strict;
use WWW::Mechanize;


if (! $ARGV[1])
{
  print "Working in console mode";
} elsif ($ARGV[1] ne 'MosMetro_Free')
{
  exit(0); # wrong network
}

my $mech = WWW::Mechanize->new(autocheck => 0);

my $url = 'http://8.8.8.8';

$mech->get($url );

my $content = $mech->content();

$content=~/URL=(.*)\"/;

$url = $1;

$mech->get($url);

$mech->submit_form( form_number => 0 );
$mech->submit_form( form_number => 0 );
{% endhighlight %}

Для работы скрипта понадобиться установить перловый модуль WWW::Mechanize;. Думаю, если вы пользуетесь wicd то вы знаете как это сделать ;-)

PS. На тему этичности автологина: я предпочитаю получать интернет от моего 3G сотового провайдера, которому я плачу за связь деньги.
К сожалению московское метро не пускает сотовых провайдеров в тоннель в должном объеме, чтобы они могли организовать там бесперебойную связь. Я считаю это
не добросовестной конкуренцией, считаю условия пользования wifi в метро не справедливыми. Поэтому считаю использование автологина этически обоснованным.

PPS. Следите за обновлениями. Пока я езжу в московском метро, и пока в метро не начнет работать 3G, я буду следить за актуальностью скрипта автологина.
Об изменениях я напишу в том числе на этой странице.